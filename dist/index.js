"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphQLQueryPurifier=void 0;const r=e(require("fs")),i=e(require("glob")),t=require("graphql"),u=e(require("path")),s=require("./merge");class a{constructor(e){this.filter=(e,r,i)=>{if(e.body&&e.body.query){const r=Object.values(this.queryMap);e.body.query=(0,s.mergeQueries)(e.body.query,r)}i()},this.gqlPath=e,this.queryMap={},this.loadQueries()}loadQueries(){i.default.sync(`${this.gqlPath}/**/*.gql`).forEach((e=>{if(".gql"===u.default.extname(e)){const i=r.default.readFileSync(e,"utf8"),u=(0,t.parse)(i).definitions.find((e=>"OperationDefinition"===e.kind)),s=u?.name?.value;s&&(this.queryMap[s]=i)}}))}}exports.GraphQLQueryPurifier=a;